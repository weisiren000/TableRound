# 记忆存储 MEM1

## 记忆时间
2024年12月19日

## 记忆类型
项目分析记忆

## 项目信息记忆

### 项目基本信息
- **项目名称**: TableRound
- **项目类型**: 多智能体对话系统
- **主要功能**: 剪纸文创产品设计
- **技术栈**: Python 3.12+, asyncio, aiohttp
- **架构模式**: 分层架构, 模块化设计

### 目录结构记忆
```
src/
├── main.py                    # 主程序入口
├── agents/                    # 智能体模块
├── core/                      # 核心模块
├── models/                    # AI模型接口
├── config/                    # 配置模块
├── utils/                     # 工具模块
└── api/                       # API接口（预留）
```

### 核心组件记忆

#### 智能体系统
- **Craftsman**: 手工艺人，60岁，蒙古族传统剪纸承人，50年经验
- **Consumer**: 消费者，关注用户需求和市场反馈
- **Manufacturer**: 制造商，考虑生产成本和工艺流程
- **Designer**: 设计师，负责创意设计和美学表达

#### 对话流程
1. 智能体自我介绍（300字限制）
2. 主题讨论（一轮对话）
3. 关键词提取和投票
4. 角色转换（保持记忆）
5. 剪纸研讨会场景讨论
6. 用户输入设计提示词
7. 图像生成

#### AI模型支持
- OpenAI (GPT系列)
- Google (Gemini系列)
- Anthropic (Claude系列)
- DeepSeek (DeepSeek系列)
- 豆包 (Doubao系列)
- OpenRouter (多模型聚合)

### 技术实现记忆

#### 异步架构
- 全面使用async/await
- aiohttp异步HTTP客户端
- 流式输出支持
- 异步生成器

#### 配置管理
- 环境变量驱动
- 多模型提供商支持
- 动态模型实例创建
- 配置序列化/反序列化

#### 图像处理
- 豆包API图像生成
- 模型: doubao-seedream-3-0-t2i-250415
- 图像下载和存储
- 图像合并功能

#### 记忆系统
- 对话历史记录
- 关键词记忆
- 角色转换记忆
- 设计卡牌记忆

### 设计模式记忆

#### 使用的设计模式
- **工厂模式**: get_model_instance方法
- **策略模式**: 统一的模型接口
- **观察者模式**: 流式输出回调
- **模板方法**: Agent基类流程

#### 架构原则
- 单一职责原则
- 开闭原则
- 依赖倒置原则
- 接口隔离原则

### 代码质量记忆

#### 优点
- 清晰的模块划分
- 完善的错误处理
- 详细的注释文档
- 异步编程最佳实践
- 配置驱动设计

#### 可改进点
- 增加单元测试
- 完善API接口
- 优化图像处理性能
- 增加更多智能体类型

### 关键文件记忆

#### 核心文件
- **main.py**: 程序入口，102行
- **settings.py**: 配置管理，266行
- **conversation.py**: 对话管理，635行
- **agent.py**: 智能体基类，449行
- **doubao.py**: 豆包模型，334行

#### 重要功能
- 多智能体对话协调
- 角色转换机制
- 关键词提取投票
- 图像生成集成
- 流式输出处理

### 环境配置记忆

#### 必需环境变量
```
AI_PROVIDER=openrouter
AI_MODEL=meta-llama/llama-4-maverick:free
OPENROUTER_API_KEY=your_key
DOUBAO_API_KEY=your_key
DOUBAO_BASE_URL=https://ark.cn-beijing.volces.com/api/v3
CRAFTSMAN_COUNT=1
CONSUMER_COUNT=3
MANUFACTURER_COUNT=1
DESIGNER_COUNT=1
MAX_TURNS=1
MAX_KEYWORDS=10
```

#### 依赖包
- aiohttp
- openai
- anthropic
- google-generativeai
- requests
- python-dotenv
- Pillow

### 使用流程记忆

#### 启动流程
1. 配置环境变量
2. 安装依赖包
3. 运行: `python src/main.py`
4. 选择操作模式
5. 输入主题和参数
6. 查看结果

#### 操作选项
1. 开始新对话
2. 处理图片
3. 设计剪纸文创产品
4. 退出

### 扩展性记忆

#### 新增智能体
1. 继承Agent基类
2. 实现特定方法
3. 添加到配置
4. 更新创建逻辑

#### 新增AI模型
1. 继承BaseModel
2. 实现接口方法
3. 添加到settings
4. 更新工厂方法

### 学习要点记忆

#### 技术要点
- 异步编程模式
- 多智能体协作
- 配置驱动设计
- 模块化架构
- 错误处理机制

#### 分析方法
- 自上而下分析
- 关键文件优先
- 设计模式识别
- 代码质量评估
- 架构原则应用

### 项目特色记忆

#### 独特功能
- 角色转换保持记忆
- 剪纸文创产品设计
- 多模型提供商支持
- 流式对话输出
- 图像生成集成

#### 技术亮点
- 完整的异步架构
- 模块化设计
- 插件化模型支持
- 配置驱动
- 良好的扩展性

## 重要提醒

### 下次分析注意事项
1. 关注测试用例的完整性
2. 评估API接口的设计
3. 分析性能优化空间
4. 检查安全性考虑
5. 了解部署和运维方案

### 可深入研究的方向
1. 多智能体协作算法
2. 角色转换机制实现
3. 图像生成优化
4. 记忆系统设计
5. 流式输出技术

### 借鉴价值
1. 异步编程最佳实践
2. 模块化架构设计
3. 配置管理方案
4. 错误处理策略
5. 代码组织结构
